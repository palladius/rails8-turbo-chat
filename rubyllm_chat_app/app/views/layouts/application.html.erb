<!DOCTYPE html>
<html>
<head>
  <title>RubyLLM Chat ‚ú®</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= action_cable_meta_tag %> <%# Required for Turbo Streams over Action Cable %>
  <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>

  <%# ICONS %>
  <%= stylesheet_link_tag "https://unpkg.com/@phosphor-icons/web@2.1.1/src/regular/style.css", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "https://unpkg.com/@phosphor-icons/web@2.1.1/src/bold/style.css", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "https://unpkg.com/@phosphor-icons/web@2.1.1/src/fill/style.css", "data-turbo-track": "reload" %>

  <%= javascript_importmap_tags %>
</head>
<body class="bg-gray-900 text-gray-100 font-sans bg-gradient-to-br from-blue-900 to-purple-900 flex flex-col">
  <%= render 'layouts/header' %>

  <% if Rails.configuration.x.config_errors.any? %>
    <div class="bg-red-500 bg-opacity-75 border border-red-700 text-white px-4 py-3 rounded relative mb-4" role="alert">
      <strong>‚ö†Ô∏è Configuration Errors:</strong>
      <ul>
        <% Rails.configuration.x.config_errors.each do |error| %>
          <li>üî¥ <%= error %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <% if Rails.configuration.x.config_warnings.any? %>
    <div class="bg-yellow-500 bg-opacity-75 border border-yellow-700 text-white px-4 py-3 rounded relative mb-4" role="alert">
      <strong>‚ö†Ô∏è Configuration Warnings:</strong>
      <ul>
        <% Rails.configuration.x.config_warnings.each do |warning| %>
          <li>üü° <%= warning %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <% if ENV['GEMINI_API_KEY'].blank? %>
    <div class="bg-yellow-500 text-white p-3 text-center">
      <strong>Warning:</strong> The `GEMINI_API_KEY` is not set. Some features may not work correctly.
    </div>
  <% end %>
  <main class="container mx-auto mt-4 px-4 flex-grow">
    <%# Flash Messages - Tailored for Tailwind %>
    <% if notice %>
      <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
        <span class="block sm:inline"><%= notice %></span>
      </div>
    <% end %>
    <% if alert %>
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
        <span class="block sm:inline"><%= alert %></span>
      </div>
    <% end %>

    <%# Main content yield %>
    <%= yield %>
  </main>
  <%= render 'layouts/footer' %>
</body>
</html>
